{
  "hash": "f9f7c2fc6d20afd8094a52eb7991e0e9",
  "result": {
    "markdown": "---\ntitle: \"Introduction to `ggplot2` - 02\"\nsubtitle: \"More about *aesthetics*.\"\nauthor:\n  - \"Horacio Lopez-Nicora\"\ndate: \"2026-02-09\"\ncategories: [ggplot2, dataviz, plotting, tidyverse]\ntitle-block-banner: false\nimage: img/penguins.png\nalttext: \"Three Palmer Penguins from the palmerpinguins package are depicted in R Studio: an Adelie Penguin, a Chinstrap Penguin, and a Gentoo Penguin. Art by Allison Horst\"\n---\n\n\n<br>\n\n![Artwork by [Allison Horst](https://twitter.com/allison_horst).](img/penguins.png){fig-align=\"center\" width=\"80%\"}\n\n<br>\n\n## Introduction\n\n#### Recap of the past session\n\nLast week's session marked the beginning of our data visualization journey with `ggplot2`. We explored the philosophy of coding graphics, created a versatile ggplot template for various charts, and discovered how to add visual elements using aesthetics and layers. Exciting times ahead!\n\n#### Session Goals\n\n-   Let's pick up on **aesthetics** and learn some more about it. Furthermore, let's introduce the  [`theme()`](https://ggplot2.tidyverse.org/reference/ggtheme.html) function.\n-   Learn the basic of **theme**, **scale**, **color**, **transparency**, **size**, and **more!** \n\n<br>\n\n## Our data set\n\n![Illustration by [Allison Horst](https://allisonhorst.github.io/palmerpenguins/articles/art.html)](img/palmerpenguins_hex.png){width=\"50%\"}\n\nWe are going to continue using our üêß data set from the package [`palmerpenguins`](https://allisonhorst.github.io/palmerpenguins/). If you haven't done so, please install that package first:\n\n\n::: {.cell}\n\n```{.r .cell-code}\ninstall.packages(\"palmerpenguins\")\n```\n:::\n\n\n[`palmerpenguins`](https://allisonhorst.github.io/palmerpenguins/index.html) is a package developed by Allison Horst, Alison Hill and Kristen Gorman, including a data set collected by Dr. Kristen Gorman at the Palmer Station Antarctica, as part of the Long Term Ecological Research Network. It is a nice, relatively simple data set to practice data exploration and visualization in R.\n\nWe'll now load the package, along with the tidyverse (which includes ggplot2):\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(palmerpenguins)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n\nAttaching package: 'palmerpenguins'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nThe following objects are masked from 'package:datasets':\n\n    penguins, penguins_raw\n```\n:::\n\n```{.r .cell-code}\nlibrary(tidyverse)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n‚îÄ‚îÄ Attaching core tidyverse packages ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ tidyverse 2.0.0 ‚îÄ‚îÄ\n‚úî dplyr     1.1.4     ‚úî readr     2.1.5\n‚úî forcats   1.0.0     ‚úî stringr   1.5.1\n‚úî ggplot2   3.5.2     ‚úî tibble    3.3.0\n‚úî lubridate 1.9.4     ‚úî tidyr     1.3.1\n‚úî purrr     1.1.0     \n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n‚îÄ‚îÄ Conflicts ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ tidyverse_conflicts() ‚îÄ‚îÄ\n‚úñ dplyr::filter() masks stats::filter()\n‚úñ dplyr::lag()    masks stats::lag()\n‚Ñπ Use the conflicted package (<http://conflicted.r-lib.org/>) to force all conflicts to become errors\n```\n:::\n:::\n\n\nOnce you've loaded that package you will have a data frame called `penguins` at your disposal --- let's take a look:\n\n\n::: {.cell}\n\n```{.r .cell-code}\npenguins\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 344 √ó 8\n   species island    bill_length_mm bill_depth_mm flipper_length_mm body_mass_g\n   <fct>   <fct>              <dbl>         <dbl>             <int>       <int>\n 1 Adelie  Torgersen           39.1          18.7               181        3750\n 2 Adelie  Torgersen           39.5          17.4               186        3800\n 3 Adelie  Torgersen           40.3          18                 195        3250\n 4 Adelie  Torgersen           NA            NA                  NA          NA\n 5 Adelie  Torgersen           36.7          19.3               193        3450\n 6 Adelie  Torgersen           39.3          20.6               190        3650\n 7 Adelie  Torgersen           38.9          17.8               181        3625\n 8 Adelie  Torgersen           39.2          19.6               195        4675\n 9 Adelie  Torgersen           34.1          18.1               193        3475\n10 Adelie  Torgersen           42            20.2               190        4250\n# ‚Ñπ 334 more rows\n# ‚Ñπ 2 more variables: sex <fct>, year <int>\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# Or glimpse() for a sort of transposed view, so we can see all columns:\nglimpse(penguins)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nRows: 344\nColumns: 8\n$ species           <fct> Adelie, Adelie, Adelie, Adelie, Adelie, Adelie, Adel‚Ä¶\n$ island            <fct> Torgersen, Torgersen, Torgersen, Torgersen, Torgerse‚Ä¶\n$ bill_length_mm    <dbl> 39.1, 39.5, 40.3, NA, 36.7, 39.3, 38.9, 39.2, 34.1, ‚Ä¶\n$ bill_depth_mm     <dbl> 18.7, 17.4, 18.0, NA, 19.3, 20.6, 17.8, 19.6, 18.1, ‚Ä¶\n$ flipper_length_mm <int> 181, 186, 195, NA, 193, 190, 181, 195, 193, 190, 186‚Ä¶\n$ body_mass_g       <int> 3750, 3800, 3250, NA, 3450, 3650, 3625, 4675, 3475, ‚Ä¶\n$ sex               <fct> male, female, female, NA, female, male, female, male‚Ä¶\n$ year              <int> 2007, 2007, 2007, 2007, 2007, 2007, 2007, 2007, 2007‚Ä¶\n```\n:::\n:::\n\n\n<br>\n\n## The Absolute Power of Aesthetics\n\n[![Aesthetics enable us to showcase multiple dimensions of our dataset in a single plot by modifying elements such as color, shape, size, labels, and transparency.](img/4plot_aesthetic.png)](http://r.qcbs.ca/workshop03/book-en/aesthetics.html)\n\n<hr style=\"height:1pt; visibility:hidden;\" />\n\n### Last week's example on \"The power of aesthetics\"\n\nLast week we **added a third aesthetic** to our graph, `color`. Our current plot mapped `bill_length_mm` to the `x` aesthetic, and `bill_depth_mm` to the `y` aesthetic --- , we then added a mapping of `species` to the `color` aesthetic:\n\n\n::: {.cell}\n\n```{.r .cell-code}\np <- ggplot(data = penguins) +\n  geom_point(mapping = aes(x = bill_length_mm,\n                           y = bill_depth_mm,\n                           color = species))\np\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-5-1.png){width=672}\n:::\n:::\n\n\n::: callout-warning\n#### Please note that we begin by using our data set to create a **plot object** with the function `ggplot()`. We then assign this object to the variable **p**. From this point forward, we can add layers by using the `+` operator.\n:::\n\n### What if we want to customize our plot?\n\nWe can do this using [`theme()`](https://ggplot2.tidyverse.org/reference/ggtheme.html). There are several options of themes which control all non-data display. Use `theme()` if you just need to tweak the display of an existing theme.\n\nFor this session, let's utilize `theme_bw()`. \n\n::: {.cell}\n\n```{.r .cell-code}\np <- ggplot(data = penguins) + theme_bw() +\n  geom_point(mapping = aes(x = bill_length_mm,\n                           y = bill_depth_mm,\n                           color = species))\np\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-6-1.png){width=672}\n:::\n:::\n\n\n### What if we want to change colors?\n\nWe can manually change colors.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Manual color change\n# By using scale_colour_manual(),\n# we can specify the exact colours we want to use\np + \nscale_color_manual(\n  # Note that the color order will correspond to\n  # the order of the species given in the legend\n  values = c(\"grey55\", \"orange\", \"skyblue\"))\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-7-1.png){width=672}\n:::\n:::\n\n\nBy using the `colors()` function, you can explore numerous color options that are available for selection.\n\n### Using a different color palette: `RColorBrewer`\n\nThere is a wide variety of `R` color packages specifically designed to offer a range of color palette options, each evoking a distinct mood. For instance, the `RColorBrewer` package provides a choice of 35 palettes!\n\n*At this point, you have become an expert in the fundamentals of `R`. Installing packages and loading them with `library()` is now second nature to you.* \n\nNow, we can install `RColorBrewer` and choose one from the many palettes it offers.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nRColorBrewer::display.brewer.all(type = \"qual\")\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-8-1.png){width=672}\n:::\n:::\n\n\nAbove, you can observe the organization of the colors into distinct groups based on their sequential, diverging, or mixed characteristics. It is important to note that varied palettes are advantageous for varying data types.\n\nLet's use these palettes with our original penguin graph. Here is an example demonstrating how the **Set1** palette is utilized to group data points with the function `scale_color_brewer()` and the palette argument.\n\n\n::: {.cell}\n\n```{.r .cell-code}\np + \nscale_color_brewer(palette = \"Set1\")\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-9-1.png){width=672}\n:::\n:::\n\n\nIn addition, the `ggplot2` package offers other functions. Two such functions are `scale_color_viridis()` and `scale_color_grey()`, which allows us to convert colors to **grayscale** without sacrificing information. This is especially important for individuals with colorblindness.\n\n\n::: {.cell}\n\n```{.r .cell-code}\np + \nscale_color_viridis_d()\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-10-1.png){width=672}\n:::\n:::\n\n\n::: callout-warning\n#### Please note that when using `scale_color_viridis()` to color data points, we need to specify whether our variable is continuous [using `scale_color_viridis_c()`] or discrete [using `scale_color_viridis_d()`]. In this case, the variable **species** is discrete.\n:::\n\n<br>\n\n::: exercise\n#### {{< fa user-edit >}} Exercise 1\n\n-   Let us revisit the scatter plot depicting the correlation between bill length and depth, distinguished by different species using colored data points.\n\n-   What if we want to use only a grayscale palette for publication purposes?\n\n<details>\n\n<summary>Hints (click here)</summary>\n\nWe can use the `scale_color_grey()` function to color our grouped data points.\n\n</details>\n\n<details>\n\n<summary>Solutions (click here)</summary>\n\n\n::: {.cell}\n\n```{.r .cell-code}\np + \nscale_color_grey()\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-11-1.png){width=672}\n:::\n:::\n\n\n</details>\n:::\n\n<br>\n\n### Colorblind-friendly palettes\n\nHave you ever contemplated how your figure might appear when viewed by individuals with different types of color blindness? We can utilize the [`colorBlindness`](https://cran.r-project.org/web/packages/colorBlindness/index.html) package to explore this aspect.\n\nLet's install the `colorBlindness` package and load it.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Let's install the colorBlindness package\ninstall.packages(\"colorBlindness\")\nlibrary(colorBlindness)\n```\n:::\n\n\nTo begin with, let's test out various colors using the `cvdPlot()` function. This will demonstrate how our current plot appears to individuals with different types of color blindness.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncolorBlindness::cvdPlot(p)\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-13-1.png){width=672}\n:::\n:::\n\n\nOur current color palette is not accessible, as can be observed. However, by using `viridis` palettes, we can ensure that our plots consistently convey the same information, regardless of the audience.\n\nLet's use the same `viridis` palette we used above to make our plot more accessible.\n\n\n::: {.cell}\n\n```{.r .cell-code}\np_viridis <- p + \nscale_color_viridis_d()\n```\n:::\n\n\nWere we successful? Let's use `cvdPlot()` to check again.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncolorBlindness::cvdPlot(p_viridis)\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-15-1.png){width=672}\n:::\n:::\n\n\n### Providing transparency with `alpha`\n\nHow can we incorporate transparency into the data points in our graph? One way to achieve this is by utilizing the `alpha` feature.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(data = penguins) +\n  geom_point(alpha = 0.5, mapping = aes(x = bill_length_mm, \n                                        y = bill_depth_mm, \n                                        color = species))\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-16-1.png){width=672}\n:::\n:::\n\n\nHere, we present an example of how to utilize the `alpha` function to incorporate transparency into our data points. By doing so, we are able to exhibit four variables within a single graph.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(data = penguins) +\n  geom_point(mapping = aes(x = bill_length_mm,\n                           y = bill_depth_mm,\n                           color = species,\n                           alpha = flipper_length_mm))\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-17-1.png){width=672}\n:::\n:::\n\n\n::: exercise\n#### {{< fa user-edit >}} Exercise 2\n\n-   We like the graph we produced above. We want, however, to also display `body_mass_g`.\n\n-   How can we add this additional variable to our graph?\n\n<details>\n\n<summary>Hints (click here)</summary>\n\nWe can use the `size` function within `aes()`.\n\n</details>\n\n<details>\n\n<summary>Solutions (click here)</summary>\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(data = penguins) +\n  geom_point(mapping = aes(x = bill_length_mm,\n                           y = bill_depth_mm,\n                           color = species,\n                           alpha = flipper_length_mm,\n                           size = body_mass_g))\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-18-1.png){width=672}\n:::\n:::\n\n\n</details>\n:::\n\n<br>\n\n\n",
    "supporting": [
      "index_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}