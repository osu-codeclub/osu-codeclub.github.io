{
  "hash": "6fe66cf52ff6c1b953520c257253d901",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Reproducibility recommendations: File organization and RStudio Projects\"\nsubtitle: \"File-related recommendations to improve the reproducibility of your research\"\npagetitle: \"Reproducibility 3\"\nauthor: \"Jelmer Poelstra\"\ndate: \"2025-09-22\"\ncategories: [reproducibility]\ntitle-block-banner: false\nnumber-depth: 3\nexecute: \n  eval: true\neditor_options: \n  chunk_output_type: console\nbibliography: references.bib\nnocite: |\n  @wilson2017, @turing2025\n---\n\n\n\n------------------------------------------------------------------------\n\n![Artwork by [\\@allison_horst](https://twitter.com/allison_horst)](img/rproj.png)\n\n<br>\n\n## Introduction: Reproducibility\n\nAfter covering Quarto in the first two sessions,\ntoday is the third of a series of Code Club sessions covering several\ntopics under the umbrella of \"reproducibility\".\n\n### What is reproducibility?\n\nI would like to start by taking a step back to talk about reproducibility in general.\nWhat do we mean by **reproducibility**?\nYour research is reproducible when third parties are \n**able to perform the same analysis on your data, and produce the same results.**\n\nReproducibility is perhaps a low bar compared to the related concept of **replicability**,\nwhich is the ability to produce the same (qualitative) results when applying the\nsame analysis to _different data_.\nHere is a helpful table showing these two and two other related concepts:\n\n![From [The Turing Way](https://book.the-turing-way.org/reproducible-research/reproducible-research)](img/reproducible-matrix.jpg){fig-align=\"center\" width=\"65%\" .lightbox}\n\nFor example:\n\n- Say that you've written a paper in which you present the results of one of your\n  research projects.\n  When this research is fully reproducible,\n  it means that someone else should be able to be able to run the exact same analysis\n  and produce all the results and figures using your paper and its associated documentation.\n\n- Relatedly, when you work in a reproducible manner and you abandon an analysis for say two years,\n  you will be able to pick up from where you left off without much trouble.\n\n<hr style=\"height:1pt; visibility:hidden;\" />\n\n### Using R is already a big step in the right direction!\n\nIt is inherently more reproducible to write code, such as in R,\nthan to do analyses by clicking in a program with a Graphical User Interface (GUI).\nThis is because it it is easy to save your code and thereby to document and communicate what you did,\nbut rather tedious to do this when you worked in a GUI.\n\nIn addition, R is open source and freely available.\nIf you use a proprietary program that requires an expensive license,\nyour work may be reproducible in principle, but for many people.\nwon't be in practice.\n\n<hr style=\"height:1pt; visibility:hidden;\" />\n\n### Additional aspects of reproducibility and what we'll cover in Code Club\n\nResearch that is fully reproducible should use a set of tools and best-practices\nrelated to:\n\n- File organization [_(this session)_]{style=\"color:darkgrey\"}\n- Code style and organization [_(next two sessions)_]{style=\"color:darkgrey\"}\n- Version management [_(Git at the end of the semester)_]{style=\"color:darkgrey\"}\n- Data and code sharing [_(In part: Git at the end of the semester)_]{style=\"color:darkgrey\"}\n- Software management [_(Within R with _renv_ - may cover this later?)_]{style=\"color:darkgrey\"}\n- Project documentation\n\n### Today\n\nToday, we'll go over the following four recommendations related to file organization\nthat improve your research projects' reproducibility.\n\n1. Use a self-contained folder for each project\n2. Separate files using a consistent subfolder structure\n3. Use relative paths in your code\n4. Use RStudio Projects, not `setwd()`\n\nAnd at the bottom of the page, there is at-home reading material on a fifth\nrecommendation:\n\n5. Use good file names\n\n<hr style=\"height:1pt; visibility:hidden;\" />\n\n## Use a self-contained folder for each project\n\nUsing a self-contained folder, or really a hierarchy of folders,\nfor one project means that you:\n\n- Don't mix files for multiple distinct projects inside one folder.\n- Don't keep files for one project in multiple places.\n\nFor example:\n\n![_Two research project folder hierarchies. Each box is a folder.<br>The way to read this is that the blue `data` folder is contained within the `project1` folder,<br>which in turn is contained within the Documents folder._](img/proj-dirs.svg){fig-align=\"center\" width=\"60%\" fig-alt=\"A diagram showing two research project folder hierarchies.\" .lightbox}\n\n<hr style=\"height:1pt; visibility:hidden;\" />\n\nUsing a self-contained folder for each projects has many downstream benefits\nand is fundamental to using other reproducibility-related best practices.\nIt also is more convenient in the long run,\nas it is easier to find files, harder to accidentally throw away stuff, etc.\n\n<hr style=\"height:1pt; visibility:hidden;\" />\n\n## Separate files using a consistent subfolder structure\n\nWithin your project's directory hierarchy,\nyou should use a consistent subfolder structure to separate different kinds of files --\nfor example, you should separate:\n\n- Code\n- Raw data\n- Results (including \"processed data\")\n\nAdditionally, you should use plenty of subfolders to separate different kinds\nof results, and so on.\nWhile the specifics can depend a lot on what kind of data you have and how you\nare analyzing it,\nhere is one good way of organizing a research project folder:\n\n![_An example research project folder structure.<br>(The README file is your overall project documentation file, and additional documentation like lab notebooks are stored in `doc`.)_](img/proj-ex_annot.svg){fig-align=\"center\" width=\"70%\" .lightbox}\n\n::: callout-tip\n#### Related recommendations\n\n- Treat raw data as read-only and as highly valuable\n- Avoid manually editing intermediate results\n:::\n\n<hr style=\"height:1pt; visibility:hidden;\" />\n\n## Use relative paths in your code\n\n### Key terms\n\nTo understand the recommendation to use relative paths in your code,\nlet's start by going over the following terms:\n\n1. **\"Directory\"** (**\"dir\"** for short) is another word for folder that is\n   commonly used in coding contexts.\n\n2. Your **\"working directory\"** is the directory where you are currently located.\n   When you start R,\n   it will always have a starting point at a specific location in your computer.\n   You can see what your working directory is with the function `getwd()`\n   (short for \"get working dir\"):\n\n\n\n   ::: {.cell}\n   \n   ```{.r .cell-code}\n   getwd()\n   ```\n   \n   ::: {.cell-output .cell-output-stdout}\n   \n   ```\n   [1] \"/Users/poelstra.1/Library/CloudStorage/Dropbox/mcic/teach/codeclub/codeclub-site/posts/S10E03_reprod_03\"\n   ```\n   \n   \n   :::\n   :::\n\n\n\n3. The output of `getwd()` is a **path**,\n   which specifies the location of a file or folder on a computer.\n   In R's output, folders are separated by forward slashes, as shown above.\n\n<hr style=\"height:1pt; visibility:hidden;\" />\n\n::: callout-warning\n### Native paths on Windows versus Mac and Linux\n\nEven though R will report paths with forward slashes regardless of the operating\nsystem, **Windows natively uses backslashes**.\nAdditionally, there are multiple root directories on Windows, indicated by letters.\nHere is an example native Windows file path:\n\n```{.bash-out-solo}\nC:\\Users\\John Doe\\Desktop\\cats.png\n```\n\nVersus an example Mac (or Linux) file path:\n\n```{.bash-out-solo}\n/Users/John Doe/Desktop/cats.png\n```\n\n**If you are on Windows, we recommend you _specify_ paths in R with forward slashes**,\nbecause:\n\n1. It makes the path specification universal, i.e. independent of the operating system.\n2. Because backslashes have a separate purpose in R,\n   if you wanted to use backslashes, you'd actually need **two**.\n   For example: `setwd(\"C:\\\\Users\\\\John Doe\")`. This is confusing and error-prone!\n:::\n\n<hr style=\"height:1pt; visibility:hidden;\" />\n\n### Absolute and relative paths\n\nThere are two types of paths:\n\n- **Absolute paths**, also referred to as full paths,\n  start from (one of) the computer's root (top-level) directory.\n  They correctly point to a file or folder regardless of what your working dir is.\n  \n  _If you think of a path as a way to point to a geographic location,_\n  _then absolute paths are like GPS coordinates._\n\n- **Relative paths** start from a specific working dir,\n  and won't work if you're located elsewhere.\n  \n  _Again thinking of a path as a way to point to a geographic location,_\n  _then relative paths are like directions like \"Take the second left\"._\n  \n![The absolute versus a relative path to a file. The relative path has the `project1` folder as the starting point.](img/proj-paths1.png){fig-align=\"center\" width=\"70%\" .lightbox}\n\n<hr style=\"height:1pt; visibility:hidden;\" />\n\n::: exercise\n#### {{< fa user-edit >}} Exercise: paths\n\n1. In the image below, what is the absolute path to `todo_list.txt`?\n2. If your working dir is `oneils`, what is the relative path to `todo_list.txt`?\n3. If your working dir is `documents`, what is the relative path to `todo_list.txt`?\n\n![Example dir structure on a Mac computer, from @oneil2019 ([link to chapter](https://open.oregonstate.education/computationalbiology/chapter/the-command-line-and-filesystem/))](img/oneil_filesystem_ex2.png){fig-align=\"center\" width=\"50%\" fig-alt=\"A diagram of an example dir structure on a Mac computer.\" .lightbox}\n:::\n\n<hr style=\"height:1pt; visibility:hidden;\" />\n\n### Why you should prefer relative paths\n\nDon't absolute paths sound better? What could be a disadvantage of them?\n\nAbsolute paths:\n\n- Don't generally work across computers\n- Break when your move a project folder hierarchy to a a different place on your computer\n\nOn the other hand, this does not apply to relative paths that use the root\nproject folder as the working dir.\nThose paths keep working when moving the folder within and between computers:\n\n<hr style=\"height:1pt; visibility:hidden;\" />\n\n![Compared to the earlier image, everything was moved into a folder `OndeDrive`.<br>This resulted in a change in the absolute path, but not to this relative path.](img/proj-paths2.png){fig-align=\"center\" width=\"80%\" .lightbox}\n\n<hr style=\"height:1pt; visibility:hidden;\" />\n\n::: exercise\n\nSo, relative paths are preferred,\n**but only when used in the following way:**\n\n1. Your working directory is always your project's root directory\n   (`project1` in the example above)\n2. You use relative paths that start at this directory\n\n:::\n\n<hr style=\"height:1pt; visibility:hidden;\" />\n\n## Use RStudio Projects, not `setwd()`\n\nIf your R working directory is not where you want it to be,\nyou can change it with the `setwd()` function.\nHowever, there is a better way -- letting RStudio Projects set your working dir!\n\n### RStudio Projects\n\n**RStudio Projects are an RStudio-specific concept that create a special file**,\n`.Rproj`, whose location designates the R working directory when you open\nthat project.\n\n<details><summary>Given what we talked about so far, in which dir(s) do you think RStudio Projects should generally be created?</summary>\n\nIn a project's root directory! For example, in `project1` in the diagram above. \n</details>\n\nCreate a new RStudio Project:\n\n1. Click `File` > `New Project` > `New Directory` > `New project`\n2. In the next window:\n   - Type `codeclub-project-practice` as the \"Directory name\".\n   - You may use the default location (parent dir) or change it -- up to you.\n   - Don't check any of the boxes\n\n![](img/new-rstudio-project.png){fig-align=\"center\" width=\"60%\" .lightbox}\n\nAfter RStudio automatically reloads,\n**the R working directory will be set to the dir in which your RStudio Project file is located.**\nTherefore, you should see the file ending in `.Rproj`\nin the RStudio `Files` tab in the lower right pane.\nAlso, you can check your working dir:\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ngetwd()\n```\n:::\n\n\n\n<hr style=\"height:1pt; visibility:hidden;\" />\n\n### Why RStudio Projects are useful\n\nIn brief, RStudio Projects help you to organize your work and make it more reproducible:\n\n- When using Projects, you can avoid manually setting your working directory altogether.\n  To refer to files within the project, you **can use relative file paths**.\n  This way, even if you move the project directory,\n  or copy it to a different computer, the same paths will still work.\n\n- Projects encourage you to organize research projects inside self-contained folder\n  hierarchies exactly as recommended above.\n  \n- When you switch between Projects, R will restart ---\n  and this is a good thing, since you don't want to randomly carry over objects and\n  loaded packages across research projects.\n\nRStudio Projects are also convenient because:\n\n- Projects record which scripts (and R Markdown files) are open in RStudio,\n  and will reopen all of those when you reopen the project.\n  This becomes quite handy, say, when you work on three different projects,\n  each of which uses a number of different scripts.\n- The Files tab will always be (or at least start) in sync with your working dir\n  \n<hr style=\"height:1pt; visibility:hidden;\" />\n\n### Using relative paths to refer to files within the project\n\nLet's recall the aforementioned way you should use relative paths:\n\n1. Your working directory should always be your project's root directory\n   [_=> this is taken care of by using RStudio projects and avoiding `setwd()`_]{style=\"color:darkgoldenrod\"}\n2. You should use relative paths that start at this directory\n   [_=> we'll practice that now_]{style=\"color:darkgoldenrod\"}\n\nHere are a few examples of using relative paths in R:\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# [Don't run - fictional examples]\nread_tsv(\"data/experiment1.tsv\")\nggsave(\"results/figures/barplot.png\")\n```\n:::\n\n\n\nTwo key aspects of specifying paths in R:\n\n- You have to use quotes (either double or single quotes) around the path\n- As soon as you open quotes, either in the console or in your script,\n  R will assume that you are trying to specify a path,\n  and you can use **Tab completion** to essentially browse through your files.\n  Practice with that in the exercise below!\n\n![_When you open quotes in the R console, your script, or Quarto code blocks, and press Tab, you can essentially browse your files starting from your working dir._](img/tab-paths3.png){fig-align=\"center\" width=\"50%\" .lightbox}\n\n::: callout-note\n#### Accessing files that aren't in the project dir\n\nOccasionally, you may need to access a file that is outside of your project dir\n(but the less that happens, the better -- and this comes down to proper file organization).\nIn that case, you can either use an absolute path,\nor a relative path that starts by going \"up\" one or more levels.\nYou can navigate up with the `..` notation, for example:\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# [Don't run - fictional examples]\n# The file is located in the dir:\nread_tsv(\"../myfile.tsv\")\n\n# The file is located in the dir Downloads, which is two levels up:\nread_tsv(\"../../Downloads/myfile.tsv\")\n```\n:::\n\n\n:::\n\n::: exercise\n#### {{< fa user-edit >}} Exercise: File organization and relative paths\n\n\n\n::: {.cell}\n\n:::\n\n\n\nIn this exercise, you are working on a mock research project within\nthe folder that you created above (your RStudio Project folder).\nYou will practice with file organization and using relative paths.\n   \n1. You will be writing to file some mock data,\n   a computed summary of the data, a plot based on the data,\n   and an R script.\n   Create an appropriate dir structure for those files within your\n   RStudio Project dir.\n   It's up to you how you do this: in the RStudio file panes,\n   in your computer's file explorer, or with R functions (`dir.create)`).\n\n   <details><summary>Click here to see a solution</summary>\n  \n   From the above description,\n   it seems appropriate to create `data`, `results`, and `scripts` dirs.\n   Here, I'm also choosing to create a dir `plots` within results for plots.\n   \n\n\n   ::: {.cell}\n   \n   ```{.r .cell-code}\n   dir.create(\"data\")\n   dir.create(\"results/plots\", recursive = TRUE)\n   dir.create(\"scripts\")\n   ```\n   :::\n\n\n   </details>\n\n2. Open a new R script (`File` > `New File` > `R Script`) and save it in an\n   appropriate location within your newly created dir structure.\n   Then, add all the code for the next exercises in that script.\n   \n   <details><summary>Click here to see a solution</summary>\n   It would be appropriate to save the script in a dir specifically for script,\n   which was called `scripts` in the answer above.\n   E.g., you could save it as `scripts/exercise.R`.\n   </details>\n\n3. Load the tidyverse as follows:\n\n\n\n   ::: {.cell}\n   \n   ```{.r .cell-code}\n   library(tidyverse)\n   ```\n   \n   ::: {.cell-output .cell-output-stderr}\n   \n   ```\n   ── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──\n   ✔ dplyr     1.1.4     ✔ readr     2.1.5\n   ✔ forcats   1.0.0     ✔ stringr   1.5.1\n   ✔ ggplot2   3.5.2     ✔ tibble    3.3.0\n   ✔ lubridate 1.9.4     ✔ tidyr     1.3.1\n   ✔ purrr     1.1.0     \n   ── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──\n   ✖ dplyr::filter() masks stats::filter()\n   ✖ dplyr::lag()    masks stats::lag()\n   ℹ Use the conflicted package (<http://conflicted.r-lib.org/>) to force all conflicts to become errors\n   ```\n   \n   \n   :::\n   \n   ```{.r .cell-code}\n   # If that produces an error, run the following command to install, then try again:\n   # install.packages(\"tidyverse\")\n   # library(tidyverse)\n   ```\n   :::\n\n\n\n4. Now, you will have access to a dataset (data frame) called `diamonds`.\n   Modify the code below to write that data to file in an approriate location.\n   \n\n\n   ::: {.cell}\n   \n   ```{.r .cell-code}\n   write_tsv(diamonds, \"<FILE-PATH>\")\n   ```\n   :::\n\n\n   \n   <details><summary>Click here to see a solution</summary>\n   Assuming that you store the raw data in a dir called `data`:\n   \n\n\n   ::: {.cell}\n   \n   ```{.r .cell-code}\n   write_tsv(diamonds, \"data/diamonds.tsv\")\n   ```\n   :::\n\n\n   </details>\n\n5. Run the `ggplot()` code below to create a plot of the diamonds data,\n   then modify the `ggsave()` line to save your plot to file in an appropriate\n   location.\n   \n\n\n   ::: {.cell}\n   \n   ```{.r .cell-code}\n   ggplot(diamonds, aes(x = carat, y = price)) +\n     geom_point()\n   ggsave(\"<FILE-PATH>\")\n   ```\n   :::\n\n\n\n   <details><summary>Click here to see a solution</summary>\n   Assuming that you store the plot in a dir called `results/plots`:\n  \n\n\n   ::: {.cell}\n   \n   ```{.r .cell-code}\n   ggplot(diamonds, aes(x = carat, y = price)) +\n     geom_point()\n   ```\n   \n   ::: {.cell-output-display}\n   ![](index_files/figure-html/unnamed-chunk-11-1.png){width=672}\n   :::\n   \n   ```{.r .cell-code}\n   ggsave(\"results/plots/plot.png\")  \n   ```\n   \n   ::: {.cell-output .cell-output-stderr}\n   \n   ```\n   Saving 7 x 5 in image\n   ```\n   \n   \n   :::\n   :::\n\n\n   </details>\n\n6. Run the code below to summarize one aspect of the diamonds data,\n   then modify the `write_tsv()` line to save your resulting data frame to file\n   in an appropriate location.\n\n\n\n   ::: {.cell}\n   \n   ```{.r .cell-code}\n   data_summary <- diamonds |>\n     summarize(mean_price = mean(price), .by = cut)\n   write_tsv(data_summary, \"<FILE-PATH>\")\n   ```\n   :::\n\n\n   \n   <details><summary>Click here to see a solution</summary>\n   Assuming that you store the results in a dir called `results``:\n   \n\n\n   ::: {.cell}\n   \n   ```{.r .cell-code}\n   data_summary <- diamonds |>\n     summarize(mean_price = mean(price), .by = cut)\n   write_tsv(data_summary, \"results/data_summary.tsv\")\n   ```\n   :::\n\n\n   </details>\n\n7. In the RStudio files tab, take a look at the file (structure) you produced.\n\n:::\n\n<br>\n\n---------------\n\n---------------\n\n## Bonus: Use good file names\n\nHere are three principles for good file names\n([from Jenny Bryan](https://speakerdeck.com/jennybc/how-to-name-files)) ---\ngood file names:\n\n- Are machine-readable\n- Are human-readable\n- Play well with default file ordering\n\n<hr style=\"height:1pt; visibility:hidden;\" />\n\n### Machine-readable\n\nConsistent and informative naming helps you to programmatically find and process files.\n\n- Avoid spaces in file names.\n  More generally, only use the following in file names:\n  - Alphanumeric characters <kbd>A-Z</kbd>, <kbd>a-z</kbd>, <kbd>0-9</kbd>\n  - Underscores <kbd>_</kbd> and hyphens (dashes) <kbd>-</kbd>\n  - Periods (dots) <kbd>.</kbd>\n  \n- In file names, you may provide **metadata** like Sample ID and date --\n  (allowing you to easily select samples from e.g. a certain month):\n  `sample032_2016-05-03.txt`  \n\n<hr style=\"height:1pt; visibility:hidden;\" />\n\n### Human-readable\n\nOne good way to combine machine- and human-readable (opinionated recommendations):\n\n- Use **underscores** (<kbd>_</kbd>) to delimit units you may later want to\n  separate on: sampleID, treatment, date.\n- Within such units, use **dashes** (<kbd>-</kbd>) to delimit words: `grass-samples`.\n- Limit the use of **periods** (<kbd>.</kbd>) to indicate file extensions.\n- Generally *avoid capitals*.\n\nFor example:\n  \n```{.bash-out-solo}\nmmus001_treatmentA_filtered.tsv\nmmus002_treatmentA_filtered.tsv\n.\n.\nmmus086_treatmentA_filtered.tsv\n```\n\n<hr style=\"height:1pt; visibility:hidden;\" />\n\n### Play well with default file ordering\n\n- Use **leading zeros** for lexicographic sorting: `sample005`.\n- **Dates** should always be written as `YYYY-MM-DD`: `2020-10-11`.\n- **Group similar files together** by starting with same phrase,\n  and **number scripts** by execution order:\n  \n```{.bash-out-solo}\nDE-01_normalize.R\nDE-02_test.R\nDE-03_process-significant.R\n```\n\n<hr style=\"height:1pt; visibility:hidden;\" />\n",
    "supporting": [
      "index_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}