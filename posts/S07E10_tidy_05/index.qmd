---
title: "Reading in data with the tidyverse"
author:
  - "Jessica Cooperstone"
date: "2024-03-22"
categories: [r-basics, tidyverse]
title-block-banner: false
image: img/readr.png
---

```{r knitr_options, echo=FALSE}
knitr::opts_chunk$set(eval = TRUE)
```

------------------------------------------------------------------------

<br>

::: {layout-ncol=2}

<img src="img/readr.png" height="250">

<img src="img/readxl.png" height="250">

:::



```{r, echo = FALSE}
url_csv <- "https://github.com/biodash/biodash.github.io/raw/master/content/codeclub/S05E05/students.csv"
download.file(url = url_csv, destfile = "students.csv")

url_csv_noheader <- "https://github.com/biodash/biodash.github.io/raw/master/content/codeclub/S05E05/students_noheader.csv"
download.file(url = url_csv_noheader, destfile = "students_noheader.csv")

url_csv_meta <- "https://github.com/biodash/biodash.github.io/raw/master/content/codeclub/S05E05/students_with_meta.csv"
download.file(url = url_csv_meta, destfile = "students_with_meta.csv")

url_tsv <- "https://github.com/biodash/biodash.github.io/raw/master/content/codeclub/S05E05/students.tsv"
download.file(url = url_tsv, destfile = "students.tsv")
```

## Introduction

So far in code club this semester, all of the data we have used has been either made up by us, or able to be loading from data embedded within base R or a package.

Today we are going to go over reading in your own data. The tidyverse core package that contains functions for reading in (and writing out) data is [`readr`](https://readr.tidyverse.org/index.html). This package allows us to read in rectangular data - or data 

Useful references for today:

-   [`readr` documentation](https://readr.tidyverse.org/index.html) (for reading in delimited files)
-   [`readxl` docuemtation](https://readxl.tidyverse.org/) (for reading in Excel files)
-   [Data import with the tidyverse cheatsheet](https://raw.githubusercontent.com/rstudio/cheatsheets/main/data-import.pdf)
-   [Data import chapter 7](https://r4ds.hadley.nz/data-import) in R for Data Science

There are other non-core tidyverse packages for reading in data (including directly from Google Drive), you can find them [here](https://www.tidyverse.org/packages/#import) though I will not go through them today.

We will start by loading the libraries we need for today.
```{r, message = FALSE, warning = FALSE}
library(tidyverse)
library(readxl)
```

But before we actually read in data, let's talk a little bit about the different ways in which input data can be formatted.

## What are some common data formatting styles?

### `.csv`

The most common formatting style for data is comma separated values, or with the file extension `.csv`. This means that the data is delimited (i.e., separated) by commas. Often we open these files in a program like Excel, Numbers, or similar, which puts each value into its own cell, but the data actually looks like this:

```
Student ID,Full Name,favourite.food,mealPlan,AGE
1,Sunil Huffmann,Strawberry yoghurt,Lunch only,4
2,Barclay Lynn,French fries,Lunch only,5
3,Jayendra Lyne,N/A,Breakfast and lunch,7
4,Leon Rossini,Anchovies,Lunch only,
5,Chidiegwu Dunkel,Pizza,Breakfast and lunch,five
6,Güvenç Attila,Ice cream,Lunch only,6
```

Here, the first row are our column headers, and each subsequent row contains information about one student, including their student ID, full name, favorite food, meal plan, and age.

If we look at this data as a table, it looks like this:

```{r echo=FALSE, message = FALSE, warning = FALSE}
students_csv <- read_csv("students.csv")
knitr::kable(students_csv)
```


### `.tsv`

Another common data format is tab separated values, or `.tsv`. Here, instead of being separated by commas like in a `.csv`, the values are separated by tabs. Looking at the same students data in a `.tsv` format would look like this:

```
Student ID        Full Name        favourite.food        mealPlan        AGE
1        Sunil Huffmann        Strawberry yoghurt        Lunch only        4
2        Barclay Lynn        French fries        Lunch only        5
3        Jayendra Lyne        N/A        Breakfast and lunch        7
4        Leon Rossini        Anchovies        Lunch only        
5        Chidiegwu Dunkel        Pizza        Breakfast and lunch        five
6        Güvenç Attila        Ice cream        Lunch only        6
```

### `.xlsx` and `.xls`

These are Microsoft-specific file formats created using the program Excel. Since using Excel spreadsheets so so common, there are special packages that allow the reading in of these file types. If you open up a file in Excel, you can save it in a variety of different file formats, just please do this with care, as Excel has reputation of [turning gene names in to dates](https://www.theverge.com/2020/8/6/21355674/human-genes-rename-microsoft-excel-misreading-dates).

### Which file format to use?

The truth is all file formats work, and some might be better for certain instances. You might read on the internet that its better to use `.csv` files over `.xlsx.` and `.xls` for compatibility sake, but there are also benefits to Excel formats where lots of data can be stored in one file in different sheets. 

> Pick the data format that works best for your application. 

## Download data to import

The code below will let you download some files to your computer, which you can then import. These are some files that Jelmer created from R for Data Science for a [code club](https://biodash.github.io/codeclub/s05e05/#basics-of-reading-rectangular-files) many code clubs ago.

The code below allows you to download four files, in different formats, and with different structure. We will 

```{r, eval = FALSE}
# saves the url where the file is located
url_csv <- "https://github.com/biodash/biodash.github.io/raw/master/content/codeclub/S05E05/students.csv"
# downloads the file and saves in your working directory as students.csv
download.file(url = url_csv, destfile = "students.csv")

url_csv_noheader <- "https://github.com/biodash/biodash.github.io/raw/master/content/codeclub/S05E05/students_noheader.csv"
download.file(url = url_csv_noheader, destfile = "students_noheader.csv")

url_csv_meta <- "https://github.com/biodash/biodash.github.io/raw/master/content/codeclub/S05E05/students_with_meta.csv"
download.file(url = url_csv_meta, destfile = "students_with_meta.csv")

url_tsv <- "https://github.com/biodash/biodash.github.io/raw/master/content/codeclub/S05E05/students.tsv"
download.file(url = url_tsv, destfile = "students.tsv")
```


## Reading in delimited files

